<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apply for FLASH Fund - Debug Mode</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #fff;
            color: #000;
            line-height: 1.5;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .debug-panel {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 400px;
            max-height: 300px;
            background: #000;
            color: #0f0;
            padding: 20px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            overflow-y: auto;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .debug-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #0f0;
        }

        .debug-error {
            border-left-color: #f00;
            color: #f00;
        }

        .form-header {
            text-align: center;
            margin-bottom: 48px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 16px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            font-size: 1rem;
            border: 2px solid #e5e5e5;
            border-radius: 8px;
        }

        .submit-btn {
            width: 100%;
            padding: 16px 32px;
            font-size: 1.125rem;
            font-weight: 600;
            background: #000;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 32px;
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .success-message {
            display: none;
            text-align: center;
            padding: 32px;
            background: #34c759;
            color: white;
            border-radius: 12px;
            margin-top: 24px;
        }

        .error-message {
            display: none;
            text-align: center;
            padding: 16px;
            background: #ff3b30;
            color: white;
            border-radius: 8px;
            margin-top: 16px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #fff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s ease-in-out infinite;
            margin-left: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="form-header">
            <h1>Apply for $25K-$100K Funding (Debug Mode)</h1>
            <p>This is a debug version to test the success message</p>
        </div>

        <form id="applicationForm">
            <div class="form-group">
                <label for="firstName">First Name *</label>
                <input type="text" id="firstName" name="firstName" class="form-input" value="Debug" required>
            </div>

            <div class="form-group">
                <label for="lastName">Last Name *</label>
                <input type="text" id="lastName" name="lastName" class="form-input" value="Test" required>
            </div>

            <div class="form-group">
                <label for="email">Email *</label>
                <input type="email" id="email" name="email" class="form-input" value="debug@test.com" required>
            </div>

            <div class="form-group">
                <label for="companyName">Company Name *</label>
                <input type="text" id="companyName" name="companyName" class="form-input" value="Debug Company" required>
            </div>

            <button type="submit" class="submit-btn" id="submitBtn">
                Submit Application
            </button>

            <div class="success-message" id="successMessage">
                <div style="text-align: center; max-width: 600px; margin: 0 auto;">
                    <div style="font-size: 48px; margin-bottom: 24px;">âœ…</div>
                    <h2 style="font-size: 2.5rem; margin-bottom: 24px;">Application Submitted Successfully!</h2>
                    <p style="font-size: 1.25rem; margin-bottom: 32px;">Thank you for applying to FLASH Fund.</p>
                    
                    <div style="background: rgba(255,255,255,0.9); padding: 24px; border-radius: 12px; margin: 32px 0; color: #000;">
                        <h3 style="margin-bottom: 16px;">What happens next?</h3>
                        <ol style="text-align: left; max-width: 400px; margin: 0 auto; line-height: 1.8;">
                            <li><strong>Days 1-3:</strong> AI analysis of your metrics</li>
                            <li><strong>Days 4-10:</strong> Deep dive review</li>
                            <li><strong>Day 14:</strong> Decision + term sheet or feedback</li>
                        </ol>
                    </div>
                    
                    <p style="margin: 32px 0;">You'll receive a confirmation email shortly at the address you provided.</p>
                    
                    <a href="/" style="display: inline-block; padding: 12px 24px; background: white; color: #000; text-decoration: none; border-radius: 8px; font-weight: 600;">
                        Return to Homepage
                    </a>
                </div>
            </div>

            <div class="error-message" id="errorMessage">
                Something went wrong. Please try again or email us at contact@flash.zone
            </div>
        </form>
    </div>

    <div class="debug-panel" id="debugPanel">
        <h3 style="color: #0f0; margin-bottom: 10px;">DEBUG CONSOLE</h3>
        <div id="debugLog"></div>
    </div>

    <script>
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwmTSDJmqKq9GE8zBNrELhQMUAoyPCQRdTE5sOZiHBLNS6oh9kq7nYzhk9ohtktVRS6HQ/exec';

        const form = document.getElementById('applicationForm');
        const submitBtn = document.getElementById('submitBtn');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');

        function debug(message, isError = false) {
            const debugLog = document.getElementById('debugLog');
            const entry = document.createElement('div');
            entry.className = isError ? 'debug-entry debug-error' : 'debug-entry';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            debugLog.appendChild(entry);
            debugLog.scrollTop = debugLog.scrollHeight;
            console.log(message);
        }

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            debug('Form submission started');

            // Hide any previous messages
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';

            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.innerHTML = 'Submitting<span class="loading"></span>';
            debug('Submit button disabled');

            // Collect form data
            const formData = new FormData(form);
            const data = {
                timestamp: new Date().toISOString(),
                firstName: formData.get('firstName'),
                lastName: formData.get('lastName'),
                email: formData.get('email'),
                companyName: formData.get('companyName'),
                website: '',
                stage: 'Seed',
                role: 'Founder/CEO',
                industry: 'SaaS',
                timeline: 'ASAP',
                source: 'Debug Test'
            };
            debug('Form data collected: ' + JSON.stringify(data));

            try {
                // Create FormData object
                const formDataToSend = new FormData();
                Object.keys(data).forEach(key => {
                    formDataToSend.append(key, data[key]);
                });
                debug('FormData object created');

                // Send to Google Apps Script
                debug('Sending request to Google Apps Script...');
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    body: formDataToSend
                });
                debug(`Response received: Status ${response.status}`);

                // Check if request was successful
                if (response.ok) {
                    debug('Response OK, parsing JSON...');
                    const result = await response.json();
                    debug('Response parsed: ' + JSON.stringify(result));
                    
                    // Show success message
                    debug('Hiding form...');
                    form.style.display = 'none';
                    debug('Showing success message...');
                    successMessage.style.display = 'block';
                    debug('SUCCESS: Form submitted and success message shown!');
                } else {
                    throw new Error(`Server returned ${response.status}`);
                }

            } catch (error) {
                debug('ERROR: ' + error.message, true);
                errorMessage.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit Application';
            }
        });

        // Test if success message can be shown
        function testSuccessMessage() {
            debug('Testing success message display...');
            form.style.display = 'none';
            successMessage.style.display = 'block';
            debug('Success message should now be visible');
        }

        debug('Debug mode initialized');
        debug('Script URL: ' + GOOGLE_SCRIPT_URL);
    </script>
</body>
</html>